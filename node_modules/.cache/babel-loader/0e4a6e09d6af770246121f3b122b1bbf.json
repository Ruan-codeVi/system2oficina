{"ast":null,"code":"var _jsxFileName = \"/home/juan/Documentos/Front-End_Projetos-React.js/oficina/src/pages/New/index.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useContext } from 'react';\nimport './novo.css';\nimport { toast } from 'react-toastify';\nimport Header from '../../components/Header';\nimport Title from '../../components/Title';\nimport { FiPlusCircle } from 'react-icons/fi';\nimport { AuthContext } from '../../contexts/auth';\nimport firebase from '../../services/firebaseConnection';\nimport { useHistory, useParams } from 'react-router-dom'; // paragar id passado em rota\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function New() {\n  _s();\n\n  // routes\n  const {\n    id\n  } = useParams();\n  const historia = useHistory(); // Contexto\n\n  const {\n    user\n  } = useContext(AuthContext); // Estados\n\n  const [servico, setServico] = useState('Avaliacao');\n  const [status, setStatus] = useState('Aberto');\n  const [automovel, setAutomovel] = useState('');\n  const [placa, setPlaca] = useState('');\n  const [complemento, setComplemento] = useState('');\n  const [clientes, setClientes] = useState([]);\n  const [loadClientesState, setLoadClientesState] = useState(true);\n  const [clintesInputSelect, setClintesInputSelect] = useState(0);\n  const [idCliente, setIdCliente] = useState(false);\n  useEffect(() => {\n    // Carregando clientes cadastrados no firebase\n    async function loadClientes() {\n      // Indo no firebase buscar a coleção de clientes\n      await firebase.firestore().collection('clientes').get().then(snapshot => {\n        let lista = [];\n        snapshot.forEach(doc => {\n          lista.push({\n            id: doc.id,\n            nome: doc.data().nome\n          });\n        }); //Se não tiver nenhum cliente cadastradi no firebase\n\n        if (lista.length === 0) {\n          console.log('Nenhum cliente encontrado');\n          setClientes({\n            id: '1',\n            nome: ''\n          });\n          setLoadClientesState(false);\n          return;\n        }\n\n        setClientes(lista);\n        setLoadClientesState(false); // Se tiver tentando editar chamado\n\n        if (id) {\n          loadId(lista);\n        }\n      }).catch(erro => {\n        console.log(erro);\n        setLoadClientesState(false);\n        setClientes({\n          id: '1',\n          nome: ''\n        });\n      });\n    }\n\n    loadClientes();\n  }, [id]); //Registrando novo chamado no firabase\n\n  async function cadastrarChamadoFirebase(e) {\n    e.preventDefault();\n\n    if (idCliente) {\n      await firebase.firestore().collection('chamados').doc(id).update({\n        cliente: clientes[clintesInputSelect].nome,\n        servico: servico,\n        status: status,\n        complemento: complemento,\n        userID: user.uid\n      }).then(() => {\n        toast.success('Chamando editado com sucesso!');\n        setClintesInputSelect(0);\n        setComplemento('');\n        historia.push('/dashboard'); //navega usuario de volta pra dashboard\n      });\n    } //  Criando no firabe coleção chamados\n\n\n    await firebase.firestore().collection('chamados').add({\n      criado: new Date(),\n      cliente: clientes[clintesInputSelect].nome,\n      clienteID: clientes[clintesInputSelect].id,\n      servico: servico,\n      status: status,\n      automovel: automovel,\n      placa: placa,\n      complemento: complemento,\n      userID: user.uid\n    }).then(() => {\n      toast.success('Chamado criado com sucesso!');\n      setAutomovel('');\n      setPlaca('');\n      setComplemento('');\n      setClintesInputSelect(0);\n    }).catch(erro => {\n      toast.error('Erro a tentar cadastrar, tente de novo!');\n      console.log(erro);\n    });\n  } // Chamando quando troca servico\n\n\n  function trocaOpcaoSelect(e) {\n    setServico(e.target.value);\n  } // Chama quando troca status\n\n\n  function trocaOpcaoRadio(e) {\n    setStatus(e.target.value);\n  } //Chama quando troca cliente\n\n\n  function handleMudarClientes(e) {\n    setClintesInputSelect(e.target.value);\n  } // Chama quando quiser editar chamado, busca pelo id passado no url\n\n\n  async function loadId(lista) {\n    await firebase.firestore().collection('chamados').doc(id).get() // campos que podem ser editados\n    .then(snapshot => {\n      setServico(snapshot.data().servico);\n      setStatus(snapshot.data().status);\n      setComplemento(snapshot.data().complemento);\n      let index = lista.findIndex(item => item.id === snapshot.data().clienteID);\n      setClintesInputSelect(index);\n      setIdCliente(true); // ta tentando editar algum item\n    }).catch(erro => {\n      console.log(erro);\n      setIdCliente(false);\n      toast.error(\"Erro no id passado\");\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 6\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content\",\n      children: [/*#__PURE__*/_jsxDEV(Title, {\n        name: \"Novo chamado\",\n        children: /*#__PURE__*/_jsxDEV(FiPlusCircle, {\n          size: 25\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 10\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"form-profile chamado\",\n          onSubmit: cadastrarChamadoFirebase,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Cliente\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 12\n          }, this), loadClientesState ? /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            disabled: true,\n            value: \"Carregando clientes...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 14\n          }, this) : /*#__PURE__*/_jsxDEV(\"select\", {\n            value: clintesInputSelect,\n            onChange: handleMudarClientes,\n            children: clientes.map((item, index) => {\n              return /*#__PURE__*/_jsxDEV(\"option\", {\n                value: index,\n                children: item.nome\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 21\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Servi\\xE7o\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: servico,\n            onChange: trocaOpcaoSelect,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Avaliacao\",\n              children: \"Avalia\\xE7\\xE3o\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Revisao\",\n              children: \"Revis\\xE3o\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Troca de Oleo / Filtro\",\n              children: \"Troca de \\xF3leo / Filtro\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Alinhamento-Balanceamento\",\n              children: \"Alinhamento/Balanceamento\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Revisao Obrigatoria\",\n              children: \"Revis\\xE3o obrigat\\xF3ria\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Manutencao Preventiva\",\n              children: \"Manuten\\xE7\\xE3o preventiva\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Manutencao Corretiva\",\n              children: \"Manuten\\xE7\\xE3o corretiva\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Remap\",\n              children: \"Remap\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Acerto de Motor\",\n              children: \"Acerto de motor\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Eletrica\",\n              children: \"Eletrica\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"status\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: \"radio\",\n              value: \"Aberto\",\n              onChange: trocaOpcaoRadio,\n              checked: status === 'Aberto'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Em Aberto\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: \"radio\",\n              value: \"Progresso\",\n              onChange: trocaOpcaoRadio,\n              checked: status === 'Progresso'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Em Progresso\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: \"radio\",\n              value: \"Atendido\",\n              onChange: trocaOpcaoRadio,\n              checked: status === 'Atendido'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Atendido\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 14\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 18\n          }, this), idCliente && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Title, {\n              name: \"Editando chamado\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 16\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Autom\\xF3vel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              type: \"text\",\n              disabled: true,\n              placeholder: \" marca ou modelo\",\n              value: automovel,\n              onChange: e => setAutomovel(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Placa\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 35\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"placa\",\n              type: \"text\",\n              disabled: true,\n              placeholder: \"Placa\",\n              value: placa,\n              onChange: e => setPlaca(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Complemento\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            className: \"complemento\",\n            type: \"text\",\n            placeholder: \"Complemento\",\n            value: complemento,\n            onChange: e => setComplemento(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: \"Cadastrar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 12\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 10\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 8\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 6\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 4\n  }, this);\n}\n\n_s(New, \"tfihvFnRSZ2u6Op7NGIkVc4SPMQ=\", false, function () {\n  return [useParams, useHistory];\n});\n\n_c = New;\n\nvar _c;\n\n$RefreshReg$(_c, \"New\");","map":{"version":3,"sources":["/home/juan/Documentos/Front-End_Projetos-React.js/oficina/src/pages/New/index.js"],"names":["useState","useEffect","useContext","toast","Header","Title","FiPlusCircle","AuthContext","firebase","useHistory","useParams","New","id","historia","user","servico","setServico","status","setStatus","automovel","setAutomovel","placa","setPlaca","complemento","setComplemento","clientes","setClientes","loadClientesState","setLoadClientesState","clintesInputSelect","setClintesInputSelect","idCliente","setIdCliente","loadClientes","firestore","collection","get","then","snapshot","lista","forEach","doc","push","nome","data","length","console","log","loadId","catch","erro","cadastrarChamadoFirebase","e","preventDefault","update","cliente","userID","uid","success","add","criado","Date","clienteID","error","trocaOpcaoSelect","target","value","trocaOpcaoRadio","handleMudarClientes","index","findIndex","item","map"],"mappings":"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","sourcesContent":["import {useState, useEffect, useContext} from 'react';\nimport './novo.css'\nimport {toast} from 'react-toastify'\nimport Header from '../../components/Header';\nimport Title from '../../components/Title';\nimport { FiPlusCircle } from 'react-icons/fi'\nimport { AuthContext } from '../../contexts/auth'\nimport firebase from '../../services/firebaseConnection'\nimport {useHistory, useParams} from 'react-router-dom' // paragar id passado em rota\n\nexport default function New() {\n  // routes\nconst { id } = useParams()\nconst historia = useHistory()\n \n// Contexto\nconst {user} = useContext(AuthContext)\n\n  // Estados\nconst [servico, setServico] = useState('Avaliacao')\nconst [status, setStatus] = useState( 'Aberto' )\nconst [automovel, setAutomovel] = useState('')\nconst [placa, setPlaca] = useState( '' )\nconst [complemento, setComplemento] = useState('')  \nconst [clientes, setClientes] = useState( [] )\nconst [loadClientesState, setLoadClientesState] = useState( true )\nconst [clintesInputSelect, setClintesInputSelect] = useState( 0 )\nconst [idCliente, setIdCliente] = useState(false)  \n  \n  useEffect( () => {\n  // Carregando clientes cadastrados no firebase\n    async function loadClientes() {\n      // Indo no firebase buscar a coleção de clientes\n      await firebase.firestore().collection( 'clientes' )\n      .get()\n        .then( (snapshot) => {\n          let lista = []\n          snapshot.forEach( ( doc ) => {\n            lista.push( {\n              id: doc.id,\n              nome: doc.data().nome\n            })\n          } )\n        //Se não tiver nenhum cliente cadastradi no firebase\n          if ( lista.length === 0 ) {\n            console.log( 'Nenhum cliente encontrado' );\n            setClientes( { id: '1', nome: '' } )\n            setLoadClientesState( false )\n            return;\n          }\n          setClientes( lista )\n          setLoadClientesState(false)\n\n          // Se tiver tentando editar chamado\n          if ( id ) {\n            loadId(lista)\n          }\n      } )\n        .catch( ( erro ) => {\n          console.log(erro);\n          setLoadClientesState( false )\n          setClientes({id: '1', nome:''})\n      })\n    }\n\n    loadClientes()\n\n  },[id])\n \n  //Registrando novo chamado no firabase\n async function cadastrarChamadoFirebase( e ) {\n    e.preventDefault()\n   \n   if ( idCliente ) {\n     await firebase.firestore().collection( 'chamados' )\n       .doc( id )\n       .update( {\n         cliente: clientes[clintesInputSelect].nome,\n         servico: servico,\n         status: status,\n         complemento: complemento,\n         userID: user.uid\n       } )\n       .then( () => {\n         toast.success( 'Chamando editado com sucesso!' )\n         setClintesInputSelect( 0 )\n         setComplemento( '' )\n         historia.push('/dashboard') //navega usuario de volta pra dashboard\n     })\n   }\n  //  Criando no firabe coleção chamados\n   await firebase.firestore().collection( 'chamados' )\n     .add( {\n       criado: new Date(),\n       cliente: clientes[clintesInputSelect].nome,\n       clienteID: clientes[clintesInputSelect].id,\n       servico: servico,\n       status: status,\n       automovel: automovel,\n       placa: placa,\n       complemento: complemento,\n       userID: user.uid\n     } )\n     .then( () => {\n       toast.success( 'Chamado criado com sucesso!' )\n       setAutomovel( '' )\n       setPlaca( '' )\n       setComplemento('')\n       setClintesInputSelect(0)\n     } )\n     .catch( ( erro ) => {\n       toast.error('Erro a tentar cadastrar, tente de novo!')\n     console.log(erro);\n   })\n  }\n  // Chamando quando troca servico\n  function trocaOpcaoSelect(e){\n    setServico( e.target.value )\n    \n  \n  }\n  // Chama quando troca status\n  function trocaOpcaoRadio( e ) {\n    setStatus( e.target.value )\n    \n  }\n  //Chama quando troca cliente\n  function handleMudarClientes(e) {\n    setClintesInputSelect(e.target.value)\n  }\n\n// Chama quando quiser editar chamado, busca pelo id passado no url\n  async function loadId(lista) {\n    await firebase.firestore().collection( 'chamados' ).doc( id )\n      .get()\n      // campos que podem ser editados\n      .then( (snapshot) => {\n        setServico( snapshot.data().servico )\n        setStatus( snapshot.data().status )\n        setComplemento( snapshot.data().complemento )\n        \n        let index = lista.findIndex( item => item.id === snapshot.data().clienteID )\n        \n        setClintesInputSelect( index )\n        setIdCliente( true ) // ta tentando editar algum item\n        \n      } )\n      .catch( ( erro ) => {\n        console.log( erro );\n        setIdCliente( false )\n        toast.error(\"Erro no id passado\")\n    })\n  }\n\n return (\n   <div>\n     <Header />\n     \n     <div className='content'>\n       <Title name='Novo chamado'>\n         <FiPlusCircle size={25}/>\n       </Title>\n       \n       <div className='container'>\n         <form className='form-profile chamado' onSubmit={cadastrarChamadoFirebase}>\n           <label>Cliente</label>\n         \n           {loadClientesState ? (\n             <input type='text' disabled={true} value='Carregando clientes...' />\n             \n           ) : (\n            <select value={clintesInputSelect} onChange={handleMudarClientes}>\n            {/* Entrando no estado de cliente para pecorrer as informação já que é um array\n                Pegando o elemento e a posição */}\n                {clientes.map( ( item, index ) => {\n                    return (\n                    <option key={item.id} value={index}>\n                          {item.nome}\n                     </option>\n                    )\n                 })}\n               </select>\n             )\n           }\n          \n           <label>Serviço</label>\n           <select value={servico} onChange={trocaOpcaoSelect}>\n              <option value='Avaliacao'>Avaliação</option>\n              <option value='Revisao'>Revisão</option>\n              <option value='Troca de Oleo / Filtro'>Troca de óleo / Filtro</option>\n             \n              <option value='Alinhamento-Balanceamento'>Alinhamento/Balanceamento</option>\n              <option value='Revisao Obrigatoria'>Revisão obrigatória</option>\n              <option value='Manutencao Preventiva'>Manutenção preventiva</option>\n              <option value='Manutencao Corretiva'>Manutenção corretiva</option>\n             <option value='Remap'>Remap</option>\n             <option value='Acerto de Motor'>Acerto de motor</option>\n             \n              <option value='Eletrica'>Eletrica</option>\n           </select>\n           \n           \n           <label>Status</label>\n           <div className='status'>\n             <input type='radio' name='radio' value='Aberto'\n               onChange={trocaOpcaoRadio} checked={status === 'Aberto'}/>\n             <span>Em Aberto</span>\n\n             <input type='radio' name='radio' value='Progresso'\n               onChange={trocaOpcaoRadio} checked={status === 'Progresso'} />\n             <span>Em Progresso</span>\n\n             <input type='radio' name='radio' value='Atendido'\n               onChange={trocaOpcaoRadio} checked={status === 'Atendido'} />\n             <span>Atendido</span>\n           </div><br/>\n           {idCliente && (\n             <>\n               <Title name='Editando chamado'></Title>\n              <label>Automóvel</label><br/>\n              <textarea type='text'disabled={true} placeholder=' marca ou modelo'\n                value={automovel} onChange={(e)=> setAutomovel(e.target.value) }/>\n              <label>Placa</label><br />\n              <input className='placa' type='text' disabled={true}\n                placeholder='Placa' value={placa}\n                 onChange={( e ) => setPlaca( e.target.value )} />\n               </>\n           )}\n          \n           \n           <label>Complemento</label>\n           <textarea className='complemento' type='text' placeholder='Complemento'\n             value={complemento} onChange={(e)=> setComplemento(e.target.value) }/>\n           <button type='submit'>Cadastrar</button>\n         </form>\n        </div>\n     </div>\n   </div>\n );\n}"]},"metadata":{},"sourceType":"module"}
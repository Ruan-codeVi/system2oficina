{"ast":null,"code":"import _regeneratorRuntime from\"/home/juan/\\xC1rea de Trabalho/oficina/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/juan/\\xC1rea de Trabalho/oficina/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/juan/\\xC1rea de Trabalho/oficina/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import Title from'../../components/Title';import Header from'../../components/Header';import{FiEdit}from'react-icons/fi';import{toast}from'react-toastify';import{useHistory,useParams}from'react-router-dom';import{useState,useEffect}from'react';import firebase from'../../services/firebaseConnection';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Editar(){var _useParams=useParams(),id=_useParams.id;var history=useHistory();// Estados\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),clientes=_useState2[0],setClientes=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading_Cli=_useState4[0],setLoading_Cli=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),clienteSelect=_useState6[0],setClienteSelect=_useState6[1];var _useState7=useState('Avaliacao'),_useState8=_slicedToArray(_useState7,2),servico=_useState8[0],setServico=_useState8[1];var _useState9=useState('Aberto'),_useState10=_slicedToArray(_useState9,2),status=_useState10[0],setStatus=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),complemento=_useState12[0],setComplemento=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),idCliente=_useState14[0],setIdCliente=_useState14[1];// false pq não foi editado\nuseEffect(function(){// Vai trazer cliente la do firebase quando aplicação abrir \nfunction carregaClientes_Firebase(){return _carregaClientes_Firebase.apply(this,arguments);}function _carregaClientes_Firebase(){_carregaClientes_Firebase=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return firebase.firestore().collection('clientes').get()//pegar\n.then(function(snapshot){// caso de sucesso, recebe snpashot de cliente\nvar lista=[];snapshot.forEach(function(doc){//dentro de cliente, para cada documento da um push em obj\nlista.push({id:doc.id,nome:doc.data().nome});});// Verificando se lista não esta vazia\nif(lista.length===0){console.log('Nenhum cliente encontrado');setClientes([{id:'1',cliente:''}]);setLoading_Cli(false);return;}setClientes(lista);setLoading_Cli(false);// Veficando se quer editar chamado\nif(id){// chama função\nloadId(lista);}}).catch(function(erro){console.log(erro);setLoading_Cli(false);setClientes([{id:'1',cliente:''}]);});case 2:case\"end\":return _context.stop();}}},_callee);}));return _carregaClientes_Firebase.apply(this,arguments);}carregaClientes_Firebase();},[id]);// chamado quando for editar chamado\nfunction loadId(_x){return _loadId.apply(this,arguments);}// Chamado depois que editou e clicou em salvar\nfunction _loadId(){_loadId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(lista){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return firebase.firestore().collection('chamados').doc(id)// acessando doc com id passado\n.get()// vai acessar o snapshot e enviar para os estados a propriedade contendo o valor\n.then(function(snapshot){setServico(snapshot.data().servico);setStatus(snapshot.data().status);setComplemento(snapshot.data().complemento);// Achando o cliente usando o id passado\nvar index=lista.findIndex(function(item){return item.id===snapshot.data().clienteID;});setClienteSelect(index);// Se conseguiu achar, então está editando\nsetIdCliente(true);}).catch(function(erro){console.log(erro);toast.error('ID não encontrado');setIdCliente(false);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _loadId.apply(this,arguments);}function handleAtualizarChamado(_x2){return _handleAtualizarChamado.apply(this,arguments);}// chamado quando troca cliente\nfunction _handleAtualizarChamado(){_handleAtualizarChamado=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();//Se id passado ja foi validado\nif(!idCliente){_context3.next=5;break;}_context3.next=4;return firebase.firestore().collection('chamados').doc(id).update({servico:servico,status:status,complemento:complemento}).then(function(){toast.success('Chamado editado com sucesso!');setStatus('Aberto');setServico('Avaliacao');setComplemento('');// navegando usuario de volta dashboard\nhistory.push('/dashboard');}).catch(function(erro){console.log(erro);toast.error('Ops, erro ao tentar salvar, tente mais tarde');});case 4:return _context3.abrupt(\"return\");case 5:case\"end\":return _context3.stop();}}},_callee3);}));return _handleAtualizarChamado.apply(this,arguments);}function handleTrocaCliente(e){console.log('index do cli selecionado',e.target.value);console.log('Cliente selecionado',clientes[e.target.value]);setClienteSelect(e.target.value);}// Chamado quando troca serviço e manda pra state\nfunction trocaServico_Select(e){setServico(e.target.value);console.log(e.target.value);}// Chamado quando troca o status, e manda para o state\nfunction trocaStatusRadio(e){setStatus(e.target.value);console.log(e.target.value);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(Title,{name:\"Editar Chamado\",children:/*#__PURE__*/_jsx(FiEdit,{size:25})}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"form-profile\",onSubmit:handleAtualizarChamado,children:[/*#__PURE__*/_jsx(\"label\",{className:\"tipo\",children:\"Pessoa F\\xEDsica / Empresa - cnpj\"}),loading_Cli?/*#__PURE__*/_jsx(\"input\",{type:\"text\",disabled:true,value:\"Carregando clientes...\"}):/*#__PURE__*/_jsx(\"select\",{value:clienteSelect,onChange:handleTrocaCliente,children:clientes.map(function(item,index){return/*#__PURE__*/_jsx(\"option\",{value:index,children:item.nome},item.id);})}),/*#__PURE__*/_jsx(\"label\",{children:\"Servi\\xE7o\"}),/*#__PURE__*/_jsxs(\"select\",{value:servico,onChange:trocaServico_Select,children:[/*#__PURE__*/_jsx(\"option\",{value:\"Avaliacao\",children:\"Avalia\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Revisao\",children:\"Revis\\xE3o\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Revisao obrigatoria\",children:\"Revis\\xE3o obrigat\\xF3ria\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Troca de Bateria\",children:\"Troca de bateria\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Alinhamento/Balanceamento\",children:\"Alinhamento/Balanceamento\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Filtro/\\xF3leo\",children:\"Filtro/\\xF3leo\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Freios\",children:\"Freios\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Supensao\",children:\"Supens\\xE3o\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Escapamento\",children:\"Escapamento\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Motor\",children:\"Motor\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cambio\",children:\"C\\xE2mbio\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Eletrica\",children:\"Eletrica\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Computador de bordo\",children:\"Computador de bordo\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Remap\",children:\"Remap\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Troca de peca\",children:\"Troca de pe\\xE7as\"})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Status\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"status\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"radio\",value:\"Aberto\",onChange:trocaStatusRadio,checked:status==='Aberto'}),/*#__PURE__*/_jsx(\"span\",{children:\"Em Aberto\"}),/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"radio\",value:\"Progresso\",onChange:trocaStatusRadio,checked:status==='Progresso'}),/*#__PURE__*/_jsx(\"span\",{children:\"Em Progresso\"}),/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"radio\",value:\"Finalizado\",onChange:trocaStatusRadio,checked:status==='Finalizado'}),/*#__PURE__*/_jsx(\"span\",{children:\"Finalizado\"})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Complemento\"}),/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",placeholder:\"Observa\\xE7\\xF5es (Opcional).\",value:complemento,onChange:function onChange(e){return setComplemento(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"cadastrar\",type:\"submit\",children:\"Salvar\"})]})})]})]});}","map":{"version":3,"sources":["/home/juan/Área de Trabalho/oficina/src/pages/Editar/index.js"],"names":["Title","Header","FiEdit","toast","useHistory","useParams","useState","useEffect","firebase","Editar","id","history","clientes","setClientes","loading_Cli","setLoading_Cli","clienteSelect","setClienteSelect","servico","setServico","status","setStatus","complemento","setComplemento","idCliente","setIdCliente","carregaClientes_Firebase","firestore","collection","get","then","snapshot","lista","forEach","doc","push","nome","data","length","console","log","cliente","loadId","catch","erro","index","findIndex","item","clienteID","error","handleAtualizarChamado","e","preventDefault","update","success","handleTrocaCliente","target","value","trocaServico_Select","trocaStatusRadio","map"],"mappings":"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","sourcesContent":["import Title from '../../components/Title'\nimport Header from '../../components/Header'\nimport { FiEdit } from 'react-icons/fi'\nimport { toast } from 'react-toastify'\nimport {useHistory, useParams} from 'react-router-dom'\n\nimport {useState, useEffect} from 'react'  \nimport firebase from '../../services/firebaseConnection'\n\n\n\nexport default function Editar() {\n    const { id } = useParams()\n    const history = useHistory()\n// Estados\n    const [clientes, setClientes] = useState( [] )\n    const [loading_Cli, setLoading_Cli] = useState( true )\n    const [clienteSelect, setClienteSelect] = useState( 0 )\n    const [servico, setServico] = useState( 'Avaliacao' )\n    const [status, setStatus] = useState( 'Aberto' )\n    const [complemento, setComplemento] = useState( '' )\n    const [idCliente, setIdCliente] = useState(false) // false pq não foi editado\n\n    useEffect( () => {\n        // Vai trazer cliente la do firebase quando aplicação abrir \n            async function carregaClientes_Firebase() {\n              await firebase.firestore().collection( 'clientes' )\n                .get() //pegar\n                .then( (snapshot) => { // caso de sucesso, recebe snpashot de cliente\n                  let lista = []\n                  snapshot.forEach( ( doc ) => { //dentro de cliente, para cada documento da um push em obj\n                    lista.push( {\n                      id: doc.id,\n                      nome: doc.data().nome\n        \n                    })\n                  } )\n        \n                  // Verificando se lista não esta vazia\n                  if ( lista.length === 0 ) {\n                    console.log( 'Nenhum cliente encontrado' );\n                    setClientes( [{ id: '1', cliente: ''}])\n                    setLoading_Cli( false )\n                    return;\n                  }\n                  setClientes( lista )\n                  setLoading_Cli(false)\n                  \n                // Veficando se quer editar chamado\n                    if ( id ) {\n                    // chama função\n                    loadId(lista)\n                }    \n                    \n                } )\n                .catch( ( erro ) => {\n                  console.log( erro );\n                  setLoading_Cli( false )\n                  setClientes( [{ id: '1', cliente: ''}])\n                })\n          }\n          carregaClientes_Firebase()\n        },[id])\n\n    // chamado quando for editar chamado\n    async function loadId(lista) {\n        // Vendo se id passado está no firabase\n        await firebase.firestore().collection( 'chamados' ).doc( id ) // acessando doc com id passado\n            .get()\n            // vai acessar o snapshot e enviar para os estados a propriedade contendo o valor\n            .then( ( snapshot ) => {\n                setServico( snapshot.data().servico )\n                setStatus( snapshot.data().status )\n                setComplemento( snapshot.data().complemento )\n                \n                // Achando o cliente usando o id passado\n                let index = lista.findIndex(item => item.id === snapshot.data().clienteID)\n                setClienteSelect( index )\n                // Se conseguiu achar, então está editando\n                setIdCliente(true)\n            } )\n            .catch( ( erro ) => {\n                console.log( erro );\n                toast.error('ID não encontrado')\n                setIdCliente(false)\n            })\n    }\n    // Chamado depois que editou e clicou em salvar\n    async function handleAtualizarChamado(e) {\n        e.preventDefault()\n    \n        //Se id passado ja foi validado\n        if ( idCliente ) {\n            await firebase.firestore().collection( 'chamados' )\n                .doc( id )\n                .update( {\n                    servico: servico,\n                    status: status,\n                    complemento: complemento\n                } )\n                .then( () => {\n                    toast.success( 'Chamado editado com sucesso!' )\n                    setStatus( 'Aberto' )\n                    setServico('Avaliacao')\n                    setComplemento( '' )\n                    // navegando usuario de volta dashboard\n                    history.push('/dashboard')\n                } )\n                .catch( ( erro ) => {\n                    console.log( erro );\n                    toast.error('Ops, erro ao tentar salvar, tente mais tarde')\n                } )\n                \n            return;\n        }\n    }\n    \n    // chamado quando troca cliente\n  function handleTrocaCliente( e ) {\n    console.log( 'index do cli selecionado', e.target.value );\n    console.log( 'Cliente selecionado', clientes[e.target.value] );\n    setClienteSelect(e.target.value)\n  }\n    // Chamado quando troca serviço e manda pra state\n  function trocaServico_Select( e ) {\n    setServico( e.target.value )\n    console.log(e.target.value);\n  }\n    // Chamado quando troca o status, e manda para o state\n  function trocaStatusRadio( e ) {\n    setStatus(e.target.value)\n    console.log(e.target.value);\n  }\n\n return (\n   <div>\n         <Header />\n         <div className='content'>\n            <Title name='Editar Chamado'>\n            <FiEdit size={25}/>\n             </Title>\n\n             <div className='container'>\n                 <form className='form-profile' onSubmit={handleAtualizarChamado}>\n                     <label className='tipo'>Pessoa Física / Empresa - cnpj</label>\n                     {loading_Cli ? (\n                <input type='text' disabled={true} value='Carregando clientes...' />\n              ) : (\n                      <select value={clienteSelect} onChange={handleTrocaCliente}>\n                      {clientes.map( ( item, index ) => {\n                        return (\n                          <option key={item.id} value={index}>\n                            {item.nome}\n                          </option>\n                        )\n                        })}\n                      </select>\n                )}\n                     \n                     <label>Serviço</label>\n              <select value={servico} onChange={trocaServico_Select}>\n                <option value='Avaliacao'>Avaliação</option>\n                <option value='Revisao'>Revisão</option>\n                <option value='Revisao obrigatoria'>Revisão obrigatória</option>\n                <option value='Troca de Bateria'>Troca de bateria</option>\n                <option value='Alinhamento/Balanceamento'>Alinhamento/Balanceamento</option>\n                <option value='Filtro/óleo'>Filtro/óleo</option>\n                <option value='Freios'>Freios</option>\n                <option value='Supensao'>Supensão</option>\n                <option value='Escapamento'>Escapamento</option>\n                <option value='Motor'>Motor</option>\n                <option value='Cambio'>Câmbio</option>\n                <option value='Eletrica'>Eletrica</option>\n                <option value='Computador de bordo'>Computador de bordo</option>\n                <option value='Remap'>Remap</option>\n                <option value='Troca de peca'>Troca de peças</option>\n              </select>\n\n              <label>Status</label>\n              <div className='status'>\n                <input\n                  type='radio'\n                  name='radio'\n                  value='Aberto'\n                  onChange={trocaStatusRadio}\n                  checked={status === 'Aberto'}\n                />\n                <span>Em Aberto</span>\n\n                <input\n                  type='radio'\n                  name='radio'\n                  value='Progresso'\n                  onChange={trocaStatusRadio}\n                  checked={status === 'Progresso'}\n                />\n                <span>Em Progresso</span>\n                <input\n                  type='radio'\n                  name='radio'\n                  value='Finalizado'\n                  onChange={trocaStatusRadio}\n                  checked={status === 'Finalizado'}\n                />\n                <span>Finalizado</span>\n                     </div>\n                     <label>Complemento</label>\n              <textarea\n                type='text'\n                placeholder='Observações (Opcional).'\n                value={complemento}\n                onChange={(e)=> setComplemento(e.target.value)}\n              />\n              \n              <button className='cadastrar' type='submit'>Salvar</button>\n                </form>\n             </div>\n        </div>\n   </div>\n );\n}"]},"metadata":{},"sourceType":"module"}